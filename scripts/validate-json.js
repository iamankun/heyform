// Generated by An Kun

const fs = require('fs');
const path = require('path');

function validateJSON(file_path) {
  try {
    const content = fs.readFileSync(file_path, 'utf8');
    JSON.parse(content);
    console.log(`‚úÖ ${file_path} is valid JSON`);
    return true;
  } catch (error) {
    console.error(`‚ùå ${file_path} has JSON errors:`);
    console.error(`   ${error.message}`);
    return false;
  }
}

function validateAllPackageJSON() {
  console.log('üîç Validating all package.json files...');
  
  const files_to_check = [
    'package.json',
    'packages/webapp/package.json',
    'packages/server/package.json',
    'packages/utils/package.json',
    'packages/shared-types-enums/package.json',
    'packages/answer-utils/package.json'
  ];
  
  let all_valid = true;
  
  files_to_check.forEach(file => {
    if (fs.existsSync(file)) {
      const is_valid = validateJSON(file);
      if (!is_valid) {
        all_valid = false;
      }
    } else {
      console.log(`‚ö†Ô∏è  ${file} not found, skipping...`);
    }
  });
  
  if (all_valid) {
    console.log('‚úÖ All package.json files are valid!');
  } else {
    console.error('‚ùå Some package.json files have errors');
    process.exit(1);
  }
}

validateAllPackageJSON();
